# Лабораторная работа 2: Поиск глобального экстремума функции

Программа для поиска глобального минимума липшицевой функции на заданном отрезке с использованием метода вспомогательных функций на основе липшицевой константы.

---

## Описание проекта

Во второй лабораторной работе реализована программа на Python, которая:
- принимает на вход строку одномерной функции (например, `f(x) = x + sin(3.14159*x)`);
- принимает координаты концов отрезка и требуемую точность;
- использует метод с построением вспомогательных функций (нижних оценок) на основе липшицевой константы;
- находит точки пересечения вспомогательных функций для выбора следующей точки вычисления;
- выполняет визуализацию графика исходной функции и ломаной линии нижних оценок;
- выводит приближенное значение аргумента и минимального значения функции, число итераций и затраченное время.

## Алгоритм

Программа использует метод глобальной оптимизации для липшицевых функций, основанный на построении вспомогательных функций:

1. **Оценка липшицевой константы**: вычисляется через численное дифференцирование функции на заданном отрезке.

2. **Построение нижних оценок**: для каждой вычисленной точки `(x_i, f(x_i))` строится вспомогательная функция вида:
   ```
   L_i(x) = -L|x - x_i| + f(x_i)
   ```
   где `L` - липшицева константа.

3. **Нахождение точек пересечения**: для каждой пары соседних точек находятся точки пересечения их вспомогательных функций.

4. **Выбор следующей точки**: выбирается точка с минимальной нижней оценкой среди всех пересечений и границ отрезка.

5. **Условие остановки**: алгоритм останавливается, когда разница между минимальным найденным значением функции и минимальной нижней оценкой становится меньше заданной точности `eps`.

## Быстрый старт

### Установка зависимостей

```bash
pip install numpy matplotlib
```

### Запуск программы из командной строки

```bash
python global_optimizer.py "x + sin(3.14159*x)" -2 2 0.01
```

Аргументы:
- `"x + sin(3.14159*x)"` - строка с функцией
- `-2` - левая граница отрезка
- `2` - правая граница отрезка
- `0.01` - требуемая точность

### Использование в Python коде

```python
from global_optimizer import GlobalOptimizer

optimizer = GlobalOptimizer("x**2 - 10*cos(2*pi*x) + 10", -5, 5, 0.01)
x_min, f_min, iterations, elapsed_time = optimizer.optimize()

print(f"Минимум: x = {x_min}, f(x) = {f_min}")
print(f"Итераций: {iterations}, Время: {elapsed_time:.6f} сек")

# Визуализация
optimizer.visualize('result.png')
```

### Запуск демонстрации с анимацией

```bash
python demo_animation.py        # Интерактивная анимация
python demo_animation.py save   # Сохранение в GIF файл
```

В файле `demo_animation.py` можно закомментировать/раскомментировать различные функции для тестирования:
- Простая функция: `x + sin(3.14159*x)`
- Функция Растригина: `x**2 - 10*cos(2*pi*x) + 10`
- Функция Экли: `-20*exp(-0.2*sqrt(x**2)) - exp(cos(2*pi*x)) + 20 + e`
- И другие примеры

## Поддерживаемые функции

Программа поддерживает следующие математические функции:
- `sin`, `cos` - тригонометрические функции
- `exp` - экспонента
- `log` - натуральный логарифм
- `sqrt` - квадратный корень
- `abs` - модуль
- `pi` - число π
- `e` - число Эйлера

Также поддерживаются стандартные арифметические операции: `+`, `-`, `*`, `/`, `**`.

## Формат входных данных

Функция задается в виде строки с использованием переменной `x`. Примеры:

- `"x**2 + 2*x + 1"`
- `"x + sin(3.14159*x)"`
- `"x**2 - 10*cos(2*pi*x) + 10"`
- `"-20*exp(-0.2*sqrt(x**2)) - exp(cos(2*pi*x)) + 20 + e"`

## Формат выходных данных

Программа выводит:
- Приближенный аргумент минимума: `x_min`
- Минимальное значение функции: `f_min`
- Число итераций (вычислений функции)
- Затраченное время в секундах
- График с визуализацией функции, ломаной линии нижних оценок и найденного минимума

## Тестовые функции

### Функция Растригина
```
f(x) = x² - 10cos(2πx) + 10
```
На отрезке [-5, 5] имеет множество локальных минимумов. Глобальный минимум находится в точке x = 0.

### Функция Экли
```
f(x) = -20exp(-0.2√(x²)) - exp(cos(2πx)) + 20 + e
```
На отрезке [-5, 5] имеет множество локальных минимумов. Глобальный минимум находится в точке x = 0.

### Простая функция
```
f(x) = x + sin(3.14159·x)
```
На отрезке [-2, 2] имеет несколько локальных минимумов.

## Особенности реализации

1. **Метод с точками пересечения**: программа использует расчет точек пересечения вспомогательных функций и ведение верхних и нижних вершин, а не просто перебор с мелким разбиением отрезка.

2. **Адаптивная оценка липшицевой константы**: константа оценивается автоматически через численное дифференцирование функции.

3. **Визуализация**: график показывает исходную функцию, ломаную линию нижних оценок и все вычисленные точки.

4. **Эффективность**: алгоритм выбирает точки вычисления адаптивно, фокусируясь на областях с потенциально низкими значениями функции.

## Анимированная визуализация

Программа поддерживает анимированную визуализацию процесса оптимизации с использованием библиотеки `matplotlib.animation`.

### Установка дополнительных зависимостей

Для сохранения анимации в GIF файл требуется `pillow`:
```bash
pip install pillow
```

### Использование анимации

```python
from global_optimizer import GlobalOptimizer
from animation import OptimizationAnimator

optimizer = GlobalOptimizer("x + sin(3.14159*x)", -2, 2, 0.01)
animator = OptimizationAnimator(optimizer, interval=300, save_path=None)
animator.animate_optimization()
```

### Пример запуска демонстрации

```bash
python demo_animation.py        # Интерактивная анимация
python demo_animation.py save   # Сохранение в GIF файл
```

В файле `demo_animation.py` можно закомментировать/раскомментировать различные функции для тестирования.

Анимация показывает:
- График исходной функции
- Постепенное построение ломаной линии нижних оценок
- Добавление новых вычисленных точек
- Изменение текущего минимума

## Структура проекта

```
lab2/
├── global_optimizer.py  # Основной модуль с классом GlobalOptimizer
├── animation.py         # Модуль для анимированной визуализации
├── demo_animation.py    # Скрипт с демонстрацией анимации (можно выбирать функции)
└── README.md           # Документация
```

## Выводы

Реализация подтвердила понимание метода глобальной оптимизации для липшицевых функций:
- Построение вспомогательных функций на основе липшицевой константы
- Нахождение точек пересечения для выбора следующей точки вычисления
- Адаптивный выбор точек вместо равномерного разбиения
- Визуализация процесса оптимизации
