# Лабораторная работа №3
## Решение задачи условной оптимизации методом множителей Лагранжа

### Вариант задания

**Минимизировать:**
$$f(x,y) = (x-1)^2 + 2(y+1)^2$$

**При ограничениях:**
$$g_1(x,y) = x^2 + y^2 - 2 = 0$$
$$g_2(x,y) = x - y = 0$$

---

## 1. Постановка задачи

Целевая функция представляет собой взвешенную сумму квадратов отклонений от точки $(1, -1)$. Первое ограничение $g_1$ задает окружность радиуса $\sqrt{2}$ с центром в начале координат, второе ограничение $g_2$ — это прямая $y = x$. Геометрически задача сводится к поиску точек на пересечении окружности и прямой, в которых целевая функция минимальна.

---

## 2. Построение функции Лагранжа

Функция Лагранжа имеет вид:
$$L(x, y, \lambda_1, \lambda_2) = f(x,y) + \lambda_1 g_1(x,y) + \lambda_2 g_2(x,y)$$

$$L(x, y, \lambda_1, \lambda_2) = (x-1)^2 + 2(y+1)^2 + \lambda_1(x^2 + y^2 - 2) + \lambda_2(x - y)$$

### Комментарий:
**Функция Лагранжа построена верно.** Использована стандартная форма: к целевой функции добавлены ограничения, умноженные на множители Лагранжа $\lambda_1$ и $\lambda_2$. Это классическая формулировка метода множителей Лагранжа для задачи с двумя ограничениями типа равенства.

---

## 3. Вычисление частных производных

Найдем частные производные функции Лагранжа:

$$\frac{\partial L}{\partial x} = 2(x-1) + 2\lambda_1 x + \lambda_2$$

$$\frac{\partial L}{\partial y} = 4(y+1) + 2\lambda_1 y - \lambda_2$$

$$\frac{\partial L}{\partial \lambda_1} = x^2 + y^2 - 2$$

$$\frac{\partial L}{\partial \lambda_2} = x - y$$

### Комментарий:
**Все частные производные вычислены корректно.** Проверим:
- $\frac{\partial}{\partial x}[(x-1)^2] = 2(x-1)$ - верно
- $\frac{\partial}{\partial x}[\lambda_1(x^2 + y^2 - 2)] = 2\lambda_1 x$ - верно
- $\frac{\partial}{\partial y}[2(y+1)^2] = 4(y+1)$ - верно
- Производные по множителям Лагранжа дают исходные ограничения - верно

**Небольшое замечание:** можно было бы раскрыть скобки в первых двух производных для более компактной записи системы, но текущая форма тоже корректна и наглядна.

---

## 4. Система уравнений и её решение

Приравниваем частные производные к нулю:

$$\begin{cases}
2(x-1) + 2\lambda_1 x + \lambda_2 = 0 \\
4(y+1) + 2\lambda_1 y - \lambda_2 = 0 \\
x^2 + y^2 - 2 = 0 \\
x - y = 0
\end{cases}$$

**Из уравнения (4):** $x = y$

**Подставим в уравнение (3):**
$$x^2 + x^2 - 2 = 0 \implies 2x^2 = 2 \implies x^2 = 1 \implies x = \pm 1$$

Получаем две стационарные точки:
- **Точка 1:** $(1, 1)$
- **Точка 2:** $(-1, -1)$

### Комментарий:
**Решение системы выполнено рационально и без ошибок.** Использован оптимальный подход: сначала из простых уравнений (3) и (4) найдены координаты точек, а затем эти значения используются для определения множителей Лагранжа. Это эффективная стратегия решения.

**Методическое замечание:** на этом этапе уже можно было отметить, что ограничения определяют всего две точки в допустимой области, что упрощает последующий анализ — нам нужно лишь сравнить значения функции в этих точках.

---

## 5. Нахождение множителей Лагранжа

### 5.1. Для точки $(1, 1)$

Из уравнения (1): $2(1-1) + 2\lambda_1 \cdot 1 + \lambda_2 = 0$
$$2\lambda_1 + \lambda_2 = 0 \quad \text{...(5)}$$

Из уравнения (2): $4(1+1) + 2\lambda_1 \cdot 1 - \lambda_2 = 0$
$$8 + 2\lambda_1 - \lambda_2 = 0 \quad \text{...(6)}$$

Складываем (5) и (6):
$$8 + 4\lambda_1 = 0 \implies \lambda_1 = -2$$

Из (5): $\lambda_2 = -2\lambda_1 = 4$

**Результат:** $\lambda_1 = -2, \lambda_2 = 4$

### 5.2. Для точки $(-1, -1)$

Из уравнения (1): $2(-1-1) + 2\lambda_1 \cdot (-1) + \lambda_2 = 0$
$$-4 - 2\lambda_1 + \lambda_2 = 0 \quad \text{...(7)}$$

Из уравнения (2): $4(-1+1) + 2\lambda_1 \cdot (-1) - \lambda_2 = 0$
$$-2\lambda_1 - \lambda_2 = 0 \quad \text{...(8)}$$

Складываем (7) и (8):
$$-4 - 4\lambda_1 = 0 \implies \lambda_1 = -1$$

Из (8): $\lambda_2 = -2\lambda_1 = 2$

**Результат:** $\lambda_1 = -1, \lambda_2 = 2$

### Комментарий:
**Вычисления множителей Лагранжа выполнены верно.** Алгебраические преобразования корректны, метод сложения уравнений применен удачно.

**Интерпретация:** отрицательные значения $\lambda_1$ для обеих точек говорят о том, что в этих точках ограничение $g_1$ "давит" на решение — если бы радиус окружности можно было увеличить, значение целевой функции могло бы уменьшиться. Положительные $\lambda_2$ указывают, что ограничение $g_2$ также активно влияет на решение.

---

## 6. Значения целевой функции

**Для точки $(1, 1)$:**
$$f(1, 1) = (1-1)^2 + 2(1+1)^2 = 0 + 2 \cdot 4 = 8$$

**Для точки $(-1, -1)$:**
$$f(-1, -1) = (-1-1)^2 + 2(-1+1)^2 = 4 + 0 = 4$$

### Комментарий:
**Вычисления выполнены абсолютно корректно.** Видно, что точка $(-1, -1)$ дает меньшее значение функции ($f = 4$) по сравнению с точкой $(1, 1)$ ($f = 8$).

**Геометрическая интерпретация:** целевая функция имеет вид взвешенного квадрата расстояния до точки $(1, -1)$. Точка $(-1, -1)$ находится ближе к центру эллипса по суммарному взвешенному расстоянию, что и объясняет меньшее значение функции.

---

## 7. Проверка характера экстремума методом окаймленной матрицы Гессе

### 7.1. Теоретическая база

Для проверки характера условного экстремума используется **окаймленная матрица Гессе (bordered Hessian)**:

$$\bar{H} = \begin{pmatrix}
0 & 0 & \frac{\partial g_1}{\partial x} & \frac{\partial g_2}{\partial x} \\
0 & 0 & \frac{\partial g_1}{\partial y} & \frac{\partial g_2}{\partial y} \\
\frac{\partial g_1}{\partial x} & \frac{\partial g_1}{\partial y} & \frac{\partial^2 L}{\partial x^2} & \frac{\partial^2 L}{\partial x \partial y} \\
\frac{\partial g_2}{\partial x} & \frac{\partial g_2}{\partial y} & \frac{\partial^2 L}{\partial y \partial x} & \frac{\partial^2 L}{\partial y^2}
\end{pmatrix}$$

где вторые производные функции Лагранжа:
- $\frac{\partial^2 L}{\partial x^2} = 2 + 2\lambda_1$
- $\frac{\partial^2 L}{\partial y^2} = 4 + 2\lambda_1$
- $\frac{\partial^2 L}{\partial x \partial y} = 0$

**Критерий:** для задачи с $n = 2$ переменными и $m = 2$ ограничениями, точка является локальным минимумом, если $(-1)^m \det(\bar{H}) > 0$, т.е. $\det(\bar{H}) > 0$.

### Комментарий:
**Теоретическая основа изложена правильно.** Использование окаймленной матрицы Гессе — это корректный подход для проверки условного экстремума при наличии ограничений типа равенства.

**Важное уточнение:** матрица Гессе самой целевой функции $f$ положительно определена (это можно проверить: собственные значения 2 и 4 положительны), что говорит о её выпуклости. Однако для **условного** экстремума это недостаточно — нужно учитывать ограничения, что и делается через окаймленную матрицу.

---

### 7.2. Проверка для точки $(1, 1)$ с $\lambda_1 = -2$

Градиенты ограничений в точке $(1, 1)$:
$$\nabla g_1(1,1) = (2 \cdot 1, 2 \cdot 1) = (2, 2)$$
$$\nabla g_2(1,1) = (1, -1)$$

Вторые производные функции Лагранжа:
$$\frac{\partial^2 L}{\partial x^2} = 2 + 2(-2) = -2$$
$$\frac{\partial^2 L}{\partial y^2} = 4 + 2(-2) = 0$$

Окаймленная матрица Гессе:
$$\bar{H} = \begin{pmatrix}
0 & 0 & 2 & 1 \\
0 & 0 & 2 & -1 \\
2 & 2 & -2 & 0 \\
1 & -1 & 0 & 0
\end{pmatrix}$$

Вычисление определителя: $\det(\bar{H}) = 16 > 0$

**Вывод:** точка $(1, 1)$ является **локальным минимумом** условной задачи.

### 7.3. Проверка для точки $(-1, -1)$ с $\lambda_1 = -1$

Градиенты ограничений в точке $(-1, -1)$:
$$\nabla g_1(-1,-1) = (2 \cdot (-1), 2 \cdot (-1)) = (-2, -2)$$
$$\nabla g_2(-1,-1) = (1, -1)$$

Вторые производные функции Лагранжа:
$$\frac{\partial^2 L}{\partial x^2} = 2 + 2(-1) = 0$$
$$\frac{\partial^2 L}{\partial y^2} = 4 + 2(-1) = 2$$

Окаймленная матрица Гессе:
$$\bar{H} = \begin{pmatrix}
0 & 0 & -2 & 1 \\
0 & 0 & -2 & -1 \\
-2 & -2 & 0 & 0 \\
1 & -1 & 0 & 2
\end{pmatrix}$$

Вычисление определителя: $\det(\bar{H}) = 16 > 0$

**Вывод:** точка $(-1, -1)$ также является **локальным минимумом** условной задачи.

### Комментарий:
**Проверка выполнена корректно.** Для обеих точек определитель окаймленной матрицы Гессе положителен, что подтверждает наличие локального минимума в каждой из них.

**Интересный нюанс:** в обеих точках одна из вторых производных функции Лагранжа обращается в нуль (в первой точке $\frac{\partial^2 L}{\partial y^2} = 0$, во второй $\frac{\partial^2 L}{\partial x^2} = 0$). Это означает, что в направлении некоторых касательных векторов к поверхности ограничений функция ведет себя "плоско". Однако критерий окаймленного определителя все равно работает и дает однозначный ответ.

**Дополнительное пояснение:** поскольку допустимое множество состоит всего из двух изолированных точек (пересечение прямой и окружности), любая из них автоматически является и локальным минимумом, и локальным максимумом в топологическом смысле. Однако использование критерия окаймленной матрицы Гессе позволяет классифицировать эти точки с точки зрения поведения функции на близких допустимых направлениях, что методологически важно для понимания метода.

---

## 8. Итоговый ответ

### Сводная таблица результатов

| Точка | Значение $f(x,y)$ | Множители Лагранжа | Характер точки |
|-------|-------------------|---------------------|----------------|
| $(1, 1)$ | $f = 8$ | $\lambda_1 = -2, \lambda_2 = 4$ | Локальный минимум |
| $(-1, -1)$ | $f = 4$ | $\lambda_1 = -1, \lambda_2 = 2$ | Локальный минимум |

### Ответ:

**Глобальный минимум** функции при заданных ограничениях достигается в точке:
$$\boxed{(x^*, y^*) = (-1, -1)}$$

**Минимальное значение функции:**
$$\boxed{f_{\min} = 4}$$

### Комментарий:
**Ответ сформулирован полно и корректно.** Указаны обе стационарные точки, их характер, значения функции и множители Лагранжа. Правильно определен глобальный минимум.

**Визуальное представление:** если бы построить график, мы бы увидели:
- Окружность $x^2 + y^2 = 2$ радиуса $\sqrt{2} \approx 1.41$
- Прямую $y = x$
- Две точки пересечения: $(1, 1)$ и $(-1, -1)$
- Эллиптические линии уровня функции $f$ с центром в $(1, -1)$
- Точка $(-1, -1)$ расположена ближе к центру эллипсов

---

## 9. Общий анализ решения

### Что было сделано правильно:

1. **Корректная постановка задачи** — все функции и ограничения записаны верно
2. **Правильное построение функции Лагранжа** — использована стандартная форма
3. **Точное вычисление производных** — все частные производные найдены без ошибок
4. **Эффективное решение системы** — выбран рациональный путь решения
5. **Корректное вычисление множителей** — алгебра выполнена безошибочно
6. **Правильное применение критерия** — окаймленная матрица Гессе построена и проверена верно
7. **Полнота ответа** — указаны все необходимые элементы решения

### Что можно было улучшить:

1. **Недостаточно пояснений по геометрии задачи** — можно было бы в начале отметить, что допустимое множество состоит всего из двух точек, что упрощает анализ
2. **Не хватает интерпретации множителей Лагранжа** — можно было объяснить их экономический/физический смысл как меры чувствительности оптимального значения к изменению ограничений
3. **Формальное применение критерия Сильвестра** — в ситуации, когда допустимое множество конечно (всего 2 точки), достаточно было бы просто сравнить значения функции, однако применение полного критерия демонстрирует знание метода
4. **Отсутствие проверки условий регулярности** — не проверено, что градиенты ограничений линейно независимы (хотя в данном случае это очевидно)

### Особенности данной задачи:

**Геометрическая специфика:** в этой задаче ограничения определяют конечное множество из двух точек. В таких случаях метод множителей Лагранжа все еще применим, но его применение имеет скорее демонстрационный характер — для практического решения достаточно найти точки пересечения и сравнить значения функции.

**Вырожденные случаи:** обе стационарные точки имеют одну из вторых производных функции Лагранжа, равную нулю. Это не делает метод неприменимым, но показывает, что на границе выполнимости (а наши точки именно на границе) функция может вести себя нетривиально.

---

## Выводы

В ходе выполнения данной работы был применен **метод множителей Лагранжа** для решения задачи условной оптимизации с двумя нелинейными ограничениями типа равенства.

### Результаты:

1. **Математическое решение:** найдены две стационарные точки $(1, 1)$ и $(-1, -1)$, обе являются локальными минимумами
2. **Оптимальное решение:** глобальный минимум достигается в точке $(-1, -1)$ со значением $f_{\min} = 4$
3. **Множители Лагранжа:** для точки минимума $\lambda_1 = -1, \lambda_2 = 2$
4. **Проверка:** характер экстремума подтвержден через критерий окаймленной матрицы Гессе
